# DWT离散小波变换

<img  src="https://img.shields.io/badge/build-passing-green.svg"><img  src="https://img.shields.io/badge/version-1.2-blue.svg"><img  src="https://img.shields.io/badge/DWT1D-DWT2D-orange.svg">

​	DWT可用于信号降噪，数据压缩等。

## 上手指南

以下指南将帮助你在本地机器上安装和运行该项目，进行开发和测试。

#### 使用方式

1. 免编译方式：可自己编译库
2. 编译方式：将source中文件放在项目同一目录下编译运行。接下来的库和IDE版本等可以作为参考。
3. waveFilter.json文件中保存小波名字和滤波器，可以添加修改然后使用。

#### 安装要求

- opencv 3.4.1 or other version

#### 安装步骤

1. 首先你需要配置好项目的opencv环境
2. 然后克隆或下载源文件到同一目录下

​	在本地克隆该项目

```git clone  xxx.git ```

​	或者下载zip，然后解压。

## 测试

​	本c++版本dwt结果和matlab一致。

```c++
#include<iostream>
#include "dwt.h"

using namespace std;

// 使用代码
dwt::Dwt1D d("db4"); // 需要提供小波名字
std::vector<double> data = {1,2,3,4,5,6,7,8,9,10,11,12,13};
cv::Mat cA,cD;
d.dec(data,cA,cD); // 分解
cout << cA << endl;
cout << cD << endl;
cout <<"drc:" << cv::Mat(data) << endl;
std::vector<double> out;
d.rec(out,cA,cD); // 重构
std::cout << cv::Mat(out) << endl;
```

```c++
// 输出重构out，
[1.000000000003618;
 2.000000000002684;
 3.000000000001739;
 4.000000000000782;
 5.000000000000226;
 6.000000000000073;
 6.999999999999996;
 7.999999999999921;
 8.999999999999766;
 9.999999999999211;
 10.99999999999825;
 11.99999999999731;
 12.99999999999638]
```

```c++
// 使用代码
dwt::Dwt2D d("db4"); // 
cv::Mat img = (cv::Mat_<double>(10,10)<< 1,2,3,4,5,6,7,8,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,2,3,4,5,6,7,8,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,1,1,1,1,1,1,1,1,1,
               1,2,3,4,5,6,7,8,1,1);
std::cout<< "img:"<<img<<endl;
cv::Mat cA,cV,cH,cD;
d.dec(img,cA,cH,cV,cD); // 
//    std::cout << "cA:" << endl << cA << std::endl;
cv::Mat cD1;
// dwt::denoise(cD,cD1,dwt::SMOOTH); // 降噪
cv::Mat dst;
d.rec(dst,cA,cH,cV,cD); // 
//    std::cout << "cV:" << endl << cV << std::endl;
//    std::cout << "cH:" << endl << cH << std::endl;
//    std::cout << "cD:" << endl << cD << std::endl;
std::cout << "dst-rec:"<<dst<<std::endl;
```

```c++
// 输出重构dst-rec
dst-rec:[1.000000000003618, 2.000000000001827, 2.999999999999413, 3.999999999997522, 4.999999999992817, 5.999999999991328, 6.999999999990544, 7.999999999989143, 1.000000000004885, 1.000000000004873;
 0.9999999999999987, 1.000000000000389, 1.00000000000078, 1.00000000000117, 1.00000000000156, 1.00000000000195, 1.00000000000234, 1.000000000002731, 0.9999999999999987, 0.999999999999999;
 0.9999999999999989, 0.9999999999999877, 0.9999999999999758, 0.999999999999964, 0.9999999999999521, 0.9999999999999406, 0.9999999999999289, 0.9999999999999176, 0.9999999999999991, 0.9999999999999991;
 0.9999999999999989, 1.000000000000465, 1.000000000000932, 1.000000000001399, 1.000000000001866, 1.000000000002332, 1.000000000002799, 1.000000000003266, 0.9999999999999991, 0.9999999999999992;
 0.9999999999999991, 1.000000000000477, 1.000000000000956, 1.000000000001434, 1.000000000001912, 1.00000000000239, 1.000000000002868, 1.000000000003346, 0.9999999999999984, 0.9999999999999991;
 1.000000000003618, 2.000000000002228, 3.000000000000217, 3.999999999998728, 4.999999999994425, 5.999999999993337, 6.999999999992955, 7.999999999991955, 1.000000000004883, 1.000000000004873;
 0.9999999999999989, 1.000000000000477, 1.000000000000955, 1.000000000001435, 1.000000000001913, 1.00000000000239, 1.000000000002869, 1.000000000003348, 0.9999999999999989, 0.9999999999999989;
 0.9999999999999989, 0.9999999999999756, 0.9999999999999526, 0.9999999999999295, 0.9999999999999062, 0.9999999999998825, 0.9999999999998591, 0.9999999999998364, 0.9999999999999987, 0.9999999999999992;
 0.9999999999999987, 1.000000000000063, 1.000000000000128, 1.000000000000193, 1.000000000000258, 1.000000000000323, 1.000000000000388, 1.000000000000452, 0.9999999999999991, 0.9999999999999988;
 1.000000000003618, 2.000000000002152, 3.000000000000063, 3.999999999998499, 4.999999999994119, 5.999999999992955, 6.999999999992497, 7.999999999991421, 1.000000000004885, 1.000000000004873]
```

​	经测试，dwt的cA和cD均与matlab中保持一致。

## 存在问题

​	数据都是double类型，使用前需要自己检查数据类型并转换。

## 相关技术

1. Mallet的DWT算法
2. 降噪阈值函数设计

## 参考文献

- Stéphane Mallat, [A Wavelet Tour of Signal Processing](http://books.google.com/books?vid=ISBN012466606X&id=yW2kut44AsMC&dq=Wavelet+tour+of+signal+processing)
- Jian-Jiun Ding, Time frequency analysis and wavelet transform class note,the Department of Electrical Engineering, National Taiwan University (NTU), Taipei, Taiwan, 2009,2016 .<http://djj.ee.ntu.edu.tw/TFW.htm>
- https://zh.wikipedia.org/wiki/离散小波变换


